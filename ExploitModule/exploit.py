#主要负责信息处理
#如ip、port
from .auxiliary_module.auxiliary_func import AuxiliaryFunc
#from .exp import ExpBase, exp50110
from .exp import *
from .ExploitFactory import exp_register
from .ExploitFactory import ExploitFactory

from .exp import *
import os

"""先设定ip port都需要用户输入,后面再加wp"""
class Exploit:
    def __init__(self):
        aux = AuxiliaryFunc()
        self.target_ip, self.target_port = aux.target_ip_port()
        #self.local_ip, self.local_port = aux.local_ip_port()

        self.__choose_exp()
        
    def __choose_exp(self):
        self.exp_path = r"ExploitModule/exp"
        while 1:  
            exp = input("选择exp:") 
            if exp in [file.split(".")[0][3:] for file in os.listdir(self.exp_path)]:
                break
            else:
                print("输入有误请重新输入:")
        self.exp_num = exp
        
    def exploit_ing(self):
        exp_module = ExploitFactory().instance(self.exp_num)
        exp_module(self.target_ip, self.target_port).exploit()
        